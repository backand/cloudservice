<form name="$ctrl.awsForm" novalidate data-ng-submit="$ctrl.saveConnection()">
  <div us-spinner="" spinner-key="connectionView" spinner-start-active></div>
  <div class="form-group">
    <label>Connect the Lambda Launcher to your Lambda functions list using <b>AWS CloudFormation</b> to create a restricted IAM user.<br/><br/>

    Run this command using the <a href="https://aws.amazon.com/cli" target="_blank">AWS CLI</a> and we create an IAM user that only has the 'GetFunction', 'InvokeFunction' and 'ListFunctions' policies:<br/></label>
<pre><code>aws cloudformation create-stack --template-url https://s3.amazonaws.com/cdn.backand.net/cf/1/backand-rc --stack-name createbackanduser --capabilities CAPABILITY_IAM</code></pre>
    <label>Once the IAM user has been created, use this command to obtain the user's access and secret keys, then copy these values into the fields below:
<pre><code>aws cloudformation describe-stacks --stack-name createbackanduser</code></pre>  
    <label>You can also use other AWS tools to create the connection - 
       <ba-help-link key="LLSettingIAM" with-text="learn more"></ba-help-link>
    </label>
  </div>
  <hr/>
  <div class="form-group">
    <label for="aws-access-key" class="control-label">Access Key ID</label>
    <input type="text" class="form-control" id="aws-access-key" placeholder="Access Key ID" ng-model="$ctrl.aws.AccessKeyId"
      required>
  </div>
  <div class="form-group">
    <label for="aws-secret-key" class="control-label">Secret Access Key</label>
    <input type="text" style=" -webkit-text-security: disc !important;" class="form-control" placeholder="Secret Access Key"
      id="aws-secret-key" ng-model="$ctrl.aws.EncryptedSecretAccessKey" data-ng-required="!$ctrl.aws.Id">
  </div>
  <div class="form-group">
    <label for="aws-region" class="control-label">AWS Regions</label>
    <tags-input class="theme-brand" placeholder="AWS Region" add-from-autocomplete-only="true" ng-model="$ctrl.aws.AwsRegion"
      display-property="Name" min-length="0" template="regions-template.html">
      <auto-complete source="$ctrl.loadAwsRegion($query)" load-on-focus="true" load-on-empty="true" min-length="0" load-on-down-arrow="true"
        template="regions-autocomplete-template.html"></auto-complete>
    </tags-input>
  </div>
  <hr/>
  <div class="form-group">
    <div class="alert alert-warning">
        Backand takes security very seriously - all credentials entered are encrypted, and never used for any purpose other than executing your Lambda functions. You can permanently revoke our access at any time by deleting the IAM credentials. If you would like further assistance in setting up the security policy, <a href="https://www.backand.com/contact" target="_blank">please contact us</a>. 
    </div>
  </div>

  <div class="form-group">
    <button type="submit" class="btn btn-amazon btn-lg m-b-md" data-ng-disabled="$ctrl.awsForm.$invalid || $ctrl.aws.AwsRegion.length ==0">Connect with AWS</button>
    <button type="button" class="btn btn-link" data-ng-click="$ctrl.modalInstance.dismiss('cancel')" data-ng-if="$ctrl.view === 'modal'">Complete later</button>

    <button type="button" class="btn btn-default pull-right" data-ng-if="$ctrl.view !== 'modal' && $ctrl.aws.Id" data-ng-click="$ctrl.deleteConnection($ctrl.aws.Id)"><i class="glyphicon glyphicon-trash"></i> Remove</button>
  </div>
</form>

<script type="text/ng-template" id="regions-template.html">
  <div class="tag-template">
    <div>
      <span>{{$getDisplayText()}} - {{data.Code}}</span>
      <a class="remove-button" ng-click="$removeTag()" ng-bind="::$$removeTagSymbol"></a>
    </div>
  </div>
</script>

<script type="text/ng-template" id="regions-autocomplete-template.html">
  <div class="autocomplete-template">
    <div class="right-panel">
      <span ng-bind-html="$highlight($getDisplayText())"></span>
      <span> - {{data.Code}}</span>
    </div>
  </div>
</script>