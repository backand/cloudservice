<div ng-controller="RulesController as rules">

  <div id="rules-header" class="page-header clearfix">
    <div class="title-group">
      <h2 class="page-name ">Actions</h2>
      <h4 class=" page-description lead pull-left">Manage here all the server side logic and operations</h4>
    </div>
    <button ng-show="!rules.editMode"
            ng-click="rules.newAction()"
            id="new-rule-btn with-margin"
            class="btn btn-success pull-right">
      + new action
    </button>


  </div>

  <div class="row">
    <div ng-show="!rules.editMode && !rules.showTestForm" class="col-xs-4 col-md-3 rule-column">

      <ul  class="list-unstyled rule-tree">

        <li ng-repeat="item in rules.items">

          <div class="row rule-group-title">
            <a href="" ng-click="item.visible = !item.visible" class="" >
              <span class="col-xs-1">{{rules.treeSign(item)}}</span> <!-- + or - -->
              {{ ::item.title }}
            </a>
          </div>

          <ul class="rules-sub-items-list" ng-show="item.visible">

            <li ng-repeat="subitem in item.items">

              <div class="row rule-sub-title">
                <a href="" ng-click="subitem.visible = !subitem.visible">
                  <span class="col-xs-1">{{rules.treeSign(subitem)}}</span>
                  {{ ::subitem.title }}</a>
                <ba-tooltip tooltip-text="{{ ::subitem.description }}" tooltip-placement="right" class=""></ba-tooltip>
                <button
                   class="btn btn-xs btn-success pull-right"
                   ng-click="rules.newAction(subitem.dataAction)">+
                </button>
              </div>

              <ul class="rules-names-list" ng-show="subitem.visible">

                <li ng-repeat="rule in subitem.items">

                  <a href="" ng-click="rules.showAction(rule.name)" class="rule-name text-primary">
                    {{ ::rule.name}}</a>
                </li>

              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <div ng-class="(!rules.editMode || rules.showTestForm) ? 'col-xs-8 col-md-9' : 'col-xs-12'" ng-include="'views/tables/rules/new_rule.html'"></div>
    <div ng-show="rules.showTestForm" class="col-xs-4 col-md-3 test-column" ng-include="'views/tables/rules/test_code_window.html'"></div>
  </div>
</div>


